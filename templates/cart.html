{% extends 'base.html' %}

{% block title %} Cart {% endblock title %}


{% block body %}

{% load static %}



<!-- cart starts -->

<section class="h-100 h-custom">
    <div class="container py-5 h-100">
        <div class="row d-flex justify-content-center align-items-center h-100">
            <div class="col-12">
                <div class="card card-registration card-registration-2" style="border-radius: 15px; background-color: #282d32;">
                    <div class="card-body p-0">
                        <div class="row g-0">
                            <div class="col-lg-8">
                                <div class="p-5 text-white">
                                    <div class="d-flex justify-content-between align-items-center mb-5">
                                        <h1 class="fw-bold mb-0 text-white">Your Cart</h1>
                                    </div>
                                    {% if not cart_items %}
                                    <h2 class="text-center mb-5">Your Cart is Empty!</h2>
                                    <div class="pt-5">
                                        <h6 class="mb-0"><a href="{% url 'store' %}" class="text-white"><i
                                                    class="fa fa-arrow-left me-2"></i>Back to shop</a></h6>
                                    </div>
                                    {% else %}
                                    <hr class="my-4">
                                    {% for cart_item in cart_items %}
                                    <div class="row mb-4 d-flex justify-content-between align-items-center">
                                        <div class="col-md-2 col-lg-2 col-xl-2">
                                            <img src="{{ cart_item.product.images.url }}" class="img-fluid rounded-3"
                                                alt="Product Image">
                                        </div>
                                        <div class="col-md-3 col-lg-3 col-xl-3">
                                            <p class="">Product Name:</p>
                                            <a class="" href="{{ cart_item.product.get_url }}">
                                                <h6 class="text-white mt-2">{{ cart_item.product.product_name }}</h6>
                                                {% if cart_item.variations.all %}
                                                {% for item in cart_item.variations.all %}
                                                <div class="d-flex text-muted text-white-50">
                                                    <p>{{ item.variation_category | capfirst }}</p>
                                                    <p>: {{ item.variation_value | capfirst }}</p>
                                                </div>
                                                {% endfor %}
                                                {% endif %}
                                            </a>
                                        </div>
                                        <div class="col-md-3 col-lg-3 col-xl-2">
                                            <p class="">Qty:</p>
                                            <div class="d-flex align-items-center mt-2">
                                                <a href="{% url 'remove_cart' cart_item.product.id cart_item.id %}"><b class="">
                                                    <button><i class="fa fa-minus"></i></button> </b></a>&nbsp;&nbsp;

                                                <input id="form1" min="0" name="quantity"
                                                    value="{{ cart_item.quantity }}" type=""
                                                    class="form-control form-control-sm" readonly/>&nbsp;&nbsp;

                                                <form action="{% url 'add_cart' cart_item.product.id %}" method="POST">
                                                    {% csrf_token %}
                                                    {% for item in cart_item.variations.all %}
                                                    <input type="hidden" name="{{ item.variation_category | lower }}"
                                                        value="{{ item.variation_value | capfirst }}">
                                                    {% endfor %}
                                                    <button type="submit"><i class="fa fa-plus"></i></button>
                                                </form>

                                            </div>
                                        </div>
                                        <div class="col-md-3 col-lg-2 col-xl-2 offset-lg-1">
                                            <p class="">Price:</p>
                                            <h6 class="mt-2">₹{{ cart_item.product.price }}</h6>
                                        </div>
                                        <div class="col-md-1 col-lg-1 col-xl-1 text-end">
                                            <a href="{% url 'remove_cart_item' cart_item.product.id cart_item.id %}" onclick="return confirm('Are you sure?')" class="text-white">
                                                <i class="fa fa-times"></i>
                                            </a>
                                        </div>
                                    </div>
                                    <hr class="my-4">
                                    {% endfor %}
                                    <div class="pt-5">
                                        <h6 class="mb-0"><a href="{% url 'store' %}" class="text-white"><i
                                                    class="fa fa-arrow-left me-2"></i>Back to shop</a></h6>
                                    </div>
                                    {% endif %}                          
                                </div>
                            </div>
                            {% if cart_items %}
                            <div class="col-lg-4 text-white" style="background-color: #30373d; border-radius: 0px 15px 15px 0px;">
                                <div class="p-5">
                                    <h3 class="fw-bold mb-5 mt-2 pt-1">Summary</h3>
                                    <hr class="my-4">

                                    <div class="d-flex justify-content-between mb-4">
                                        <h5 class="text-uppercase">Sub Total:</h5>
                                        <h5>₹{{ total }}</h5>
                                    </div>

                                    <div class="d-flex justify-content-between mb-4">
                                        <h5 class="text-uppercase">Tax:</h5>
                                        <h5>₹{{ tax }}</h5>
                                    </div>
                                    
                                    <!-- coupen  -->
                                    <h5 class="text-uppercase mb-3">Have a coupen?</h5>
                                    <form action="{% url 'coupon_apply' %}" method="POST">
                                        {% csrf_token %}
                                        <div class="mb-5">
                                            <div class="form-outline d-flex">
                                                <input type="text" id="coupon"
                                                    class="form-control form-control-lg" name="coupon"/>
                                                    <button class="btn btn-primary ms-2" id="apply" type="submit">Apply</button>
                                            </div>
                                            <label class="form-label">Enter the code</label>
                                        </div>
                                    </form>
                                    
                                    <hr class="my-4">

                                    <div class="d-flex justify-content-between mb-5">
                                        <h5 class="text-uppercase">Grand Total:</h5>
                                        <h5>₹{{ grand_total }}</h5>
                                    </div>

                                    <a href="{% url 'checkout_address' %}"><button type="button"
                                            class="btn btn-primary btn-block btn-lg"
                                            data-mdb-ripple-color="dark">Proceed to buy</button></a>

                                </div>
                            </div>
                            {% endif %}
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</section>

<!-- cart ends -->



{% endblock body %}  